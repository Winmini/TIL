# Value Type



JPA는 데이터 타입을 최상위 레벨로 보면 2가지로 분류한다. 엔티티 타입과 값 타입이다.



지금 껏 했던 타입은 엔티티 타입이다.

- 엔티티 타입
  - @Entity로 정의하는 객체
  - 데이터가 변해도 식별자로 지속해서 추적가능
  - 우리가 회원 엔티티의 키나 나이값을 변경해도 ID로 인식 가능하다.

이제 공부할 타입은 값 타입이다.

- 값 타입
  - int, Integer, String처럼 단순히 값으로 사용하는 자바 기본 타입이나 객체
  - 식별자가 없고 값만 있으므로 변경시 추적 불가
  - 숫자 100을 200으로 변경하면 완전히 다른 값으로 대체한다.



#### 값 타입 분류

- 기본값 타입
  - 자바 기본 타입(int, double)
  - 래퍼 클래스(Integer, Long)
  - String
- 임베디드 타입
  - JPA에서 정의를 해야함
  - x, y좌표같이 뭔가 묶어서 우리가 만드는 그런 값들
  - 주로 기본 값 타입을 모아서 만들어서 복합 값 타입
- 컬렉션 값 타입
  - 자바 컬렉션에 기본 값타입이나 임베디드 타입을 넣을 수 있는 것

기본 값 타입은 생명주기를 엔티티에 의존한다. 회원이라는 엔티티안에 나이, 이름 이런 기본 값 타입들은 회원 엔티티가 삭제될 때 필드는 같이 삭제된다.

**값 타입은 절대로 공유하면 안된다.**

참고로 자바의 기본 타입은 공유가 안된다. 기본 타입은 항상 값을 복사하며 래퍼클래스나 String은 공유 가능하지만 변경은 안된다. 그래서 사이드 이펙트가 발생할 여지가 막혀있다. 그래서 기본 타입은 안전하다.



##### 임베디드 타입

사는 도시, 구, 우편번호 등을 묶어서 주소라는 Value Type을 만들어 낸다고 하면 이게 임베디드 타입이다. 이런 임베디드 타입은 재사용, 높은 응집도 등이 좋다. 임베디드 타입도 결국 값 타입이라, 엔티티 생명주기에 의존한다. 그리고 디비 입장에서는 테이블이 바뀌지 않는다. 다만 객체는 객체지향적으로 설계가 되므로 좋다.

그런데 값 타입이면 값타입이라고 알려줘야 한다. 아니면 이전에 했던 매핑관계와도 혼선이 올 수 있으므로 값타입임을 알려주는 어노테이션을 달자. 값타입에 해당하는 클래스에는 `@Embeddable` 를 넣고, 기본생성자는 필수이다.  사용하는 클래스에는 `Embedded` 를 넣으면 된다. 둘 중 하나는 생략해도 되지만 둘 다 넣는 것을 권장한다.

잘 설계한 ORM 애플리케이션은 테이블의 수보다 클래스의 수가 많다.