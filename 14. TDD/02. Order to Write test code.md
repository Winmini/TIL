# Order to Write test code



테스트 코드 작성순서는 이전에서 했던 것을 일반화하면 나온다.

- 쉬운 경우에서 어려운 경우로 진행
- 예외적인 경우에서 정상적인 경우로 진행

이 순서로 하지 않으면 초반부터 복잡한 테스트를 진행하게 된다. 그럼 한 번에 구현해야할 코드가 많아진다. 한 번에 완벽한 코드를 만들면 좋겠지만 보통의 개발자는 한 번에 많은 코드를 만들다 보면 나도 모르게 버그를 만들고 나중에 버그를 잡기 위해 많은 시간을 허비하게 된다. 당연 테스트 통과 시간도 길어진다.



#### 예외 상황을 먼저 테스트해야 하는 이유

다양한 예외 상황은 복잡한 if-else 블록을 동반할 때가 많다. 예외 상황을 전혀 고려하지 않은 코드에 예외 상황을 반영하려면 코드의 구조를 뒤집거나 조건문이 중복한 경우가 늘어난다. 코드를 복잡하게 만들어 버그 발생 가능성을 높인다. 그래서 초반에 예외 상황을 테스트하면 이런 가능성이 줄어든다. 그리고 나중에 예외 상황을 처리하지 않아 발생하는 버그도 줄여주므로 좋다.



#### 완급 조절

처음 TDD로 구현할 때 어려운 것 중 하나는 한 번에 얼마만큼의 코드를 작성할 것인가이다. 처음할 때에는 다음 단계를 따라 TDD를 익혀보자.

1. 정해진 값을 리턴
2. 값 비교를 이용해서 정해진 값을 리턴
3. 다양한 테스트를 추가하면서 구현을 일반화

뻔한 구현이라도 위 단계를 거쳐서 연습하는 것과 바로 구현하는 것에는 차이가 있다. 나중에 막힐 때 차이가 더욱 두드러지니 이 단계를 습관화하자.



---

순서를 익히기 위해 다음 서비스 구현을 해보자.

매달 비용을 지불해야 사용할 수 있는 유료서비스이다. 이 서비스는 다음 규칙에 따라 서비스 만료일을 결정한다.

- 서비스를 사용하려면 매달 1만 원을 선불로 납부한다. 납부일 기준으로 한 달 뒤가 서비스 만료일이 된다.
- 2개월 이상 요금을 납부할 수 있다.
- 10만원을 납부하면 서비스를 1년 제공한다.

클래스 이름은 `ExpiryDateCalculator` 로 정하여 진행한다.